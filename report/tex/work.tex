\section{Contracts of the game}

\subsection{Contracts on Run}
\lstinputlisting[numbers=left,firstline=8, lastline=9]{../src/square_destroyer.ads}

\subsection{Contracts on Sort\_By\_Height}
\lstinputlisting[numbers=left,firstline=30, lastline=36]{../src/square_destroyer.ads}

\subsection{Contracts on Is\_Grid\_Valid}
\lstinputlisting[numbers=left,firstline=61, lastline=67]{../src/square_destroyer.ads}

\subsection{Contracts on Is\_In\_Grid}
\lstinputlisting[numbers=left,firstline=69, lastline=73]{../src/square_destroyer.ads}

\subsection{Contracts on Get\_Random\_Square}
\lstinputlisting[numbers=left,firstline=77, lastline=80]{../src/square_destroyer.ads}

\subsection{Contracts on Is\_Match\_3}
\lstinputlisting[numbers=left,firstline=84, lastline=94]{../src/square_destroyer.ads}

\subsection{Contracts on Init\_Grid}
\lstinputlisting[numbers=left,firstline=98, lastline=100]{../src/square_destroyer.ads}

\subsection{Contracts on Are\_Adjacent}
\lstinputlisting[numbers=left,firstline=107, lastline=118]{../src/square_destroyer.ads}

\subsection{Contracts on Swap}
\lstinputlisting[numbers=left,firstline=120, lastline=125]{../src/square_destroyer.ads}

\subsection{Contracts on Get\_Matching\_Neighbours}
\lstinputlisting[numbers=left,firstline=127, lastline=149]{../src/square_destroyer.ads}

\subsection{Contracts on Is\_Move\_Legal}
\lstinputlisting[numbers=left,firstline=151, lastline=157]{../src/square_destroyer.ads}

\newpage

\subsection{Contracts on Process\_Moves}
\lstinputlisting[numbers=left,firstline=159, lastline=167]{../src/square_destroyer.ads}

\subsection{Contracts on Blink}
\lstinputlisting[numbers=left,firstline=169, lastline=173]{../src/square_destroyer.ads}

\subsection{Contracts on Is\_Unsolvable}
\lstinputlisting[numbers=left,firstline=175, lastline=178]{../src/square_destroyer.ads}

\subsection{Contracts on Get\_Input}
\lstinputlisting[numbers=left,firstline=182, lastline=188]{../src/square_destroyer.ads}

\newpage

\subsection{Contracts on Update\_Grid}
\lstinputlisting[numbers=left,firstline=190, lastline=214]{../src/square_destroyer.ads}

\subsection{Contracts on Draw\_Grid}
\lstinputlisting[numbers=left,firstline=216, lastline=219]{../src/square_destroyer.ads}

\newpage

\section{Implementation of the game}

\subsection{Implementation of Sort\_By\_Height}

\noindent
This function take 2 points in parameter and return the one with the highest Y
position, or with the highest X position if A.Y = B.Y.
\lstinputlisting[numbers=left,firstline=18, lastline=25]{../src/square_destroyer.adb}

\subsection{Implementation of Is\_Grid\_Valid}
\lstinputlisting[numbers=left,firstline=29, lastline=43]{../src/square_destroyer.adb}

\subsection{Implementation of Is\_In\_Grid}
\lstinputlisting[numbers=left,firstline=45, lastline=48]{../src/square_destroyer.adb}

\newpage

\subsection{Implementation of a random \sq generator}

In order to generate \sqs we chose to use the STM32 Library.
Indeed, the library helps generate random number by utilizing the RTC on the \stmdb.

\paragraph{Code}

\noindent
First we include STM32.RNG.Interrupts.
\begin{lstlisting}
   with STM32.RNG.Interrupts; use STM32;
\end{lstlisting}


\noindent
Then we initialize the random number generator using this statement:
\begin{lstlisting}
   RNG.Interrupts.Initialize_RNG;
\end{lstlisting}


\noindent
Finally we can generate our random \sqs like this:
\lstinputlisting[numbers=left,firstline=52, lastline=56]{../src/square_destroyer.adb}

\subsection{Implementation of Is\_Match\_3}
\lstinputlisting[numbers=left,firstline=60, lastline=66]{../src/square_destroyer.adb}

\newpage

\subsection{Implementation of Init\_Grid}
\lstinputlisting[numbers=left,firstline=70, lastline=87]{../src/square_destroyer.adb}

\subsection{Implementation of Init\_Board}
\lstinputlisting[numbers=left,firstline=89, lastline=111]{../src/square_destroyer.adb}

\newpage

\subsection{Implementation of Are\_Adjacent}
\lstinputlisting[numbers=left,firstline=115, lastline=126]{../src/square_destroyer.adb}

\subsection{Implementation of Swap}
\lstinputlisting[numbers=left,firstline=128, lastline=133]{../src/square_destroyer.adb}

\subsection{Implementation of Get\_Matching\_Neighbours}
\lstinputlisting[numbers=left,firstline=135, lastline=154]{../src/square_destroyer.adb}

\newpage

\subsection{Implementation of Is\_Move\_Legal}
\lstinputlisting[numbers=left,firstline=156, lastline=179]{../src/square_destroyer.adb}

\subsection{Implementation of Process\_Moves}
\lstinputlisting[numbers=left,firstline=181, lastline=231]{../src/square_destroyer.adb}

\newpage

\subsection{Implementation of Blink}
\lstinputlisting[numbers=left,firstline=233, lastline=259]{../src/square_destroyer.adb}

\newpage

\subsection{Implementation of Is\_Unsolvable}
\lstinputlisting[numbers=left,firstline=261, lastline=298]{../src/square_destroyer.adb}

\newpage

\subsection{Implementation of Get\_Input}
\lstinputlisting[numbers=left,firstline=302, lastline=321]{../src/square_destroyer.adb}

\subsection{Implementation of Update\_Grid}
\lstinputlisting[numbers=left,firstline=323, lastline=349]{../src/square_destroyer.adb}

\subsection{Implementation of Draw\_Grid}
\lstinputlisting[numbers=left,firstline=351, lastline=370]{../src/square_destroyer.adb}

\newpage

\subsection{Implementation of Run}
\lstinputlisting[numbers=left,firstline=374, lastline=415]{../src/square_destroyer.adb}

\subsection{Implementation of Main}
\lstinputlisting[numbers=left,firstline=5, lastline=8]{../src/main.adb}

\newpage
